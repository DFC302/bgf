#!/bin/bash

# Source the patterns file
# If you move bgf to a new directroy other than home, you will need to adjust this!
. ~/bgf/patterns.sh

if [ $# -eq 0 ] ; then
	helpmenu
	exit 0
else
	while [ ! $# -eq 0 ] ; do
		case "$1" in
			--help)
				helpmenu
				exit 0
				;;
			--list)
				list
				exit 0
				;;
			--xss)
				FILE=$2
				xss
				;;
			--redirect)
				FILE=$2
				redirect
				;;
			--wordpress)
				FILE=$2
				wordpress
				;;
			--potential)
				FILE=$2
				potential
				;;
			--aws-keys)
				FILE=$2
				aws_keys
				;;
			--base-64)
				FILE=$2
				base64
				;;
			--cors)
				FILE=$2
				cors
				;;
			--debug-pages)
				FILE=$2
				debug_pages
				;;
			--debug_logic)
				FILE=$2
				debug_logic
				;;
			--firebase)
				FILE=$2
				firebase
				;;
			--fw)
				FILE=$2
				fw
				;;
			--go-functions)
				FILE=$2
				go_functions
				;;
			--http-auth)
				FILE=$2
				http_auth
				;;
			--ip)
				FILE=$2
				ip
				;;
			--json-sec)
				FILE=$2
				json_sec
				;;
			--meg-headers)
				FILE=$2
				meg_headers
				;;
			--php-curl)
				FILE=$2
				php_curl
				;;
			--php-errors)
				FILE=$2
				php_errors
				;;
			--php-serialized)
				FILE=$2
				php_serialized
				;;
			--php-sinks)
				FILE=$2
				php_sinks
				;;
			--php-sources)
				FILE=$2
				php_sources
				;;
			--s3-buckets)
				FILE=$2
				s3_buckets
				;;
			--sec)
				FILE=$2
				sec
				;;
			--servers)
				FILE=$2
				servers
				;;
			--strings)
				FILE=$2
				strings
				;;
			--takeovers)
				FILE=$2
				takeovers
				;;
			--upload-fields)
				FILE=$2
				upload_fields
				;;
			--urls)
				FILE=$2
				urls
				;;
			--no-protocol)
				FILE=$2
				no_protocol
				;;
			--wordlist)
				FILE=$2
				wordlist
				;;
			--idor)
				FILE=$2
				idor
				;;
			--lfi)
				FILE=$2
				lfi
				;;
			--rce)
				FILE=$2
				rce
				;;
			--sqli)
				FILE=$2
				sqli
				;;
			--ssrf)
				FILE=$2
				ssrf
				;;
			--ssti)
				FILE=$2
				ssti
				;;
		esac
		shift
	done
fi
